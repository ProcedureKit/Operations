steps:
  -
    name: "Lint"
    command: .ci/scripts/lint
  -
    name: "Operations: Test Mac OS X"
    command: .ci/scripts/operations-test-osx
    agents:
      swift: "2.2"
  -
    name: "Operations: Test iOS"
    command: .ci/scripts/operations-test-ios
    env:
      FL_SLATHER_BUILDKITE_ENABLED: true
      FL_SLATHER_COVERALLS_ENABLED: true
    agents:
      swift: "2.2"
  -
    name: "ProcedureKit: macOS"
    command: "source /usr/local/opt/chruby/share/chruby/chruby.sh && chruby ruby && bundle install --quiet && bundle exec fastlane mac test"
    agents:
      swift: "3.0"
  -
    name: "ProcedureKit: iOS"
    command: "source /usr/local/opt/chruby/share/chruby/chruby.sh && chruby ruby && bundle install --quiet && bundle exec fastlane ios test_ios"
    agents:
      iOS-Simulator: true
      swift: "3.0"
  -
    name: "ProcedureKit: tvOS"
    command: "source /usr/local/opt/chruby/share/chruby/chruby.sh && chruby ruby && bundle install --quiet && bundle exec fastlane ios test_tvos"
    agents:
      iOS-Simulator: true
      swift: "3.0"
  -
    name: "Mobile: iOS"
    command: "source /usr/local/opt/chruby/share/chruby/chruby.sh && chruby ruby && bundle install --quiet && bundle exec fastlane ios test_mobile_ios"
    agents:
      iOS-Simulator: true    
      swift: "3.0"
  -
    name: "Mobile: tvOS"
    command: "source /usr/local/opt/chruby/share/chruby/chruby.sh && chruby ruby && bundle install --quiet && bundle exec fastlane ios test_mobile_tvos"
    agents:
      iOS-Simulator: true    
      swift: "3.0"
  -
    name: "Mac: macOS"
    command: "source /usr/local/opt/chruby/share/chruby/chruby.sh && chruby ruby && bundle install --quiet && bundle exec fastlane mac test_mac"
    agents:
      swift: "3.0"
  -
    name: "TV: tvOS"
    command: "source /usr/local/opt/chruby/share/chruby/chruby.sh && chruby ruby && bundle install --quiet && bundle exec fastlane ios test_tv_tvos"
    agents:
      iOS-Simulator: true    
      swift: "3.0"
  -
    name: "Cloud: macOS"
    command: "source /usr/local/opt/chruby/share/chruby/chruby.sh && chruby ruby && bundle install --quiet && bundle exec fastlane mac test_cloud"
    agents:
      swift: "3.0"
  -
    name: "Cloud: iOS"
    command: "source /usr/local/opt/chruby/share/chruby/chruby.sh && chruby ruby && bundle install --quiet && bundle exec fastlane ios test_ios_cloud"
    agents:
      iOS-Simulator: true    
      swift: "3.0"
  -
    name: "Cloud: tvOS"
    command: "source /usr/local/opt/chruby/share/chruby/chruby.sh && chruby ruby && bundle install --quiet && bundle exec fastlane ios test_tvos_cloud"
    agents:
      iOS-Simulator: true    
      swift: "3.0"      
